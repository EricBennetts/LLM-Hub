<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LLM-Hub社区论坛</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/vue-router@4/dist/vue-router.global.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="app">
    <!-- 页眉 -->
    <header class="app-header">
        <div class="header-title">
            <router-link to="/" class="home-link">LLM Hub</router-link>
        </div>
        <nav class="header-nav">
            <!-- 情况A: 如果用户未登录 (loggedInUser 为 null) -->
            <div v-if="!loggedInUser">
                <button class="nav-btn" @click="openLoginModal">登录</button>
                <button class="nav-btn" @click="openRegistrationModal">注册</button>
            </div>
            <!-- 情况B: 如果用户已登录 -->
            <div v-else class="user-info">
                <span>欢迎, {{ loggedInUser.username }}</span>
                <button class="nav-btn-create" @click="openCreatePostModal">发布新帖</button>
                <button class="nav-btn-logout" @click="logout">退出</button>
            </div>
        </nav>
    </header>
    <div v-if="!loggedInUser" class="login-prompt-banner">
        您当前未登录，<a href="#" @click.prevent="openLoginModal">登录</a>后即可发表帖子
    </div>

    <!-- 路由视图 -->
    <router-view :key="routerViewKey"></router-view>
<!--    <div class="posts-container">-->
<!--        <h1>社区帖子</h1>-->

<!--        <div class="post-item" v-for="post in posts" :key="post.id">-->
<!--            <h3 class="post-title">{{ post.title }}</h3>-->
<!--            <p class="post-meta">作者: {{ post.authorUsername }} | 发布于: {{ formatTime(post.createTime) }}</p>-->
<!--            <p class="post-content">{{ post.content }}</p>-->
<!--        </div>-->
<!--        <p v-if="posts.length === 0">暂无帖子，快来发布第一篇吧！</p>-->
<!--    </div>-->

    <!-- 2. 将原来的登录框改造成登录模态框 -->
    <div class="modal-overlay" v-if="isLoginModalVisible">
        <div class="modal-content">
            <div class="modal-header">
                <h2>用户登录</h2>
                <button class="close-btn" @click="closeLoginModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="login-username-input">用户名</label>
                <input type="text" id="login-username-input" v-model="loginUser.username" placeholder="请输入用户名">
            </div>
            <div class="form-group">
                <label for="login-password-input">密码</label>
                <input type="password" id="login-password-input" v-model="loginUser.password" placeholder="请输入密码">
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" @click="closeLoginModal">取消</button>
                <button class="btn-primary" @click="handleLogin">登录</button>
            </div>
            <div class="registration-prompt">
                还没有账号？ <button @click="switchToRegisterModal">立即注册</button>
            </div>
        </div>
    </div>

    <!-- 注册模态框保持不变 -->
    <div class="modal-overlay" v-if="isRegistrationModalVisible">
        <div class="modal-content">
            <div class="modal-header">
                <h2>新用户注册</h2>
                <button class="close-btn" @click="closeRegistrationModal">&times;</button>
            </div>
            <!-- 表单区域 -->
            <div class="form-group">
                <label for="username-input"><span class="required">*</span> 用户名</label>
                <input type="text" id="username-input" v-model="newUser.username" placeholder="请输入用户名">
            </div>
            <div class="form-group">
                <label for="email-input"><span class="required">*</span> 电子邮箱</label>
                <input type="email" id="email-input" v-model="newUser.email" placeholder="请输入邮箱">
            </div>
            <div class="form-group">
                <label for="password-input"><span class="required">*</span> 密码</label>
                <input type="password" id="password-input" v-model="newUser.password" placeholder="请输入密码">
            </div>
            <div class="form-group">
                <label for="confirm-password-input"><span class="required">*</span> 确认密码</label>
                <input type="password" id="confirm-password-input" v-model="newUser.confirmPassword" placeholder="请再次输入密码">
            </div>
            <!-- 动作按钮区域 -->
            <div class="modal-actions">
                <button class="btn-secondary" @click="closeRegistrationModal">取消</button>
                <button class="btn-primary" @click="registerUser">确定</button>
            </div>
        </div>
    </div>

    <!-- 发布新帖模态框 -->
    <div class="modal-overlay" v-if="isCreatePostModalVisible">
        <div class="modal-content">
            <div class="modal-header">
                <h2>发布新帖子</h2>
                <button class="close-btn" @click="closeCreatePostModal">&times;</button>
            </div>
            <div class="form-group-column">
                <label for="post-title-input">标题</label>
                <input type="text" id="post-title-input" v-model="newPost.title" placeholder="请输入帖子标题">
            </div>
            <div class="form-group-column">
                <label for="post-content-input">内容</label>
                <textarea id="post-content-input" v-model="newPost.content" placeholder="请输入帖子内容..." rows="8"></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" @click="closeCreatePostModal">取消</button>
                <button class="btn-primary" @click="handleCreatePost">发布</button>
            </div>
        </div>
    </div>

    <!-- 这是 #app 的结束标签 -->
</div>


<script src="script.js"></script>
</body>
</html>